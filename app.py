import streamlit as st

# ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏©
st.set_page_config(page_title="CarbonPulse - TGO Edition", page_icon="üå±")

# --- ‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏±‡∏ß‡∏Ç‡∏≠‡∏á‡πÅ‡∏≠‡∏õ ---
st.title("üå± CarbonPulse (TGO Data)")
# ‡∏õ‡∏£‡∏±‡∏ö‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£: ‡∏°‡∏≤‡πÄ‡∏ä‡πá‡∏Å‡∏Å‡∏±‡∏ô‡∏ß‡πà‡∏≤‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏≤‡∏£‡πå‡∏ö‡∏≠‡∏ô‡πÑ‡∏õ‡πÄ‡∏ó‡πà‡∏≤‡πÑ‡∏´‡∏£‡πà?
st.subheader("‡∏°‡∏≤‡πÄ‡∏ä‡πá‡∏Å‡∏Å‡∏±‡∏ô‡∏ß‡πà‡∏≤‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏≤‡∏£‡πå‡∏ö‡∏≠‡∏ô‡πÑ‡∏õ‡πÄ‡∏ó‡πà‡∏≤‡πÑ‡∏´‡∏£‡πà?")
st.write("‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡πà‡∏≤‡∏Å‡∏≤‡∏£‡∏õ‡∏•‡πà‡∏≠‡∏¢‡∏Å‡πä‡∏≤‡∏ã‡πÄ‡∏£‡∏∑‡∏≠‡∏ô‡∏Å‡∏£‡∏∞‡∏à‡∏Å‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å **‡∏≠‡∏ö‡∏Å. (TGO)**")

st.divider()

# --- 1. ‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á (‡∏≠‡∏¥‡∏á‡∏ï‡∏≤‡∏°‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ TGO) ---
st.header("1. ‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á üöó")
transport = st.selectbox(
    "‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡∏î‡πâ‡∏ß‡∏¢‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏î‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏•‡∏±‡∏Å?",
    ["‡πÄ‡∏î‡∏¥‡∏ô/‡∏õ‡∏±‡πà‡∏ô‡∏à‡∏±‡∏Å‡∏£‡∏¢‡∏≤‡∏ô", "‡∏£‡∏ñ‡πÑ‡∏ü‡∏ü‡πâ‡∏≤ (BTS/MRT)", "‡∏£‡∏ñ‡πÄ‡∏°‡∏•‡πå‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏∞", "‡∏£‡∏ñ‡∏¢‡∏ô‡∏ï‡πå‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß (‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô)", "‡∏£‡∏ñ‡∏¢‡∏ô‡∏ï‡πå‡πÑ‡∏ü‡∏ü‡πâ‡∏≤ (EV)", "‡∏°‡∏≠‡πÄ‡∏ï‡∏≠‡∏£‡πå‡πÑ‡∏ã‡∏Ñ‡πå"]
)
distance = st.number_input("‡∏£‡∏∞‡∏¢‡∏∞‡∏ó‡∏≤‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (‡∏Å‡∏¥‡πÇ‡∏•‡πÄ‡∏°‡∏ï‡∏£)", min_value=0.0, step=0.5)

# --- 2. ‡∏Å‡∏≤‡∏£‡∏ö‡∏£‡∏¥‡πÇ‡∏†‡∏Ñ (‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ï‡∏≠‡∏ö‡πÄ‡∏≠‡∏á‡∏≠‡∏¥‡∏™‡∏£‡∏∞) ---
st.header("2. ‡∏Å‡∏≤‡∏£‡∏Å‡∏¥‡∏ô üç±")
st.write("‡∏•‡∏≠‡∏á‡∏û‡∏¥‡∏°‡∏û‡πå‡πÄ‡∏°‡∏ô‡∏π‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏≤‡∏ô‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ (‡πÄ‡∏ä‡πà‡∏ô ‡∏Ç‡πâ‡∏≤‡∏ß‡∏Å‡∏∞‡πÄ‡∏û‡∏£‡∏≤‡πÄ‡∏ô‡∏∑‡πâ‡∏≠, ‡∏™‡∏•‡∏±‡∏î‡∏ú‡∏±‡∏Å)")
food_input = st.text_input("‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏≤‡∏ô‡∏≠‡∏∞‡πÑ‡∏£‡πÑ‡∏õ‡∏ö‡πâ‡∏≤‡∏á?", "").lower()

# --- 3. ‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô ---
st.header("3. ‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô ‚ö°")
ac_hours = st.slider("‡πÄ‡∏õ‡∏¥‡∏î‡πÅ‡∏≠‡∏£‡πå‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏Å‡∏µ‡πà‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á?", 0, 24, 0)

st.divider()

# --- ‡∏™‡πà‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì (Logic ‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á ‡∏≠‡∏ö‡∏Å.) ---
if st.button("‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡πÅ‡∏•‡∏∞‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ ‚ú®"):
    # 1. ‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á (kgCO2e per km) - ‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á TGO
    t_factors = {
        "‡πÄ‡∏î‡∏¥‡∏ô/‡∏õ‡∏±‡πà‡∏ô‡∏à‡∏±‡∏Å‡∏£‡∏¢‡∏≤‡∏ô": 0.0,
        "‡∏£‡∏ñ‡πÑ‡∏ü‡∏ü‡πâ‡∏≤ (BTS/MRT)": 0.04,
        "‡∏£‡∏ñ‡πÄ‡∏°‡∏•‡πå‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏∞": 0.06,
        "‡∏£‡∏ñ‡∏¢‡∏ô‡∏ï‡πå‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß (‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô)": 0.22,
        "‡∏£‡∏ñ‡∏¢‡∏ô‡∏ï‡πå‡πÑ‡∏ü‡∏ü‡πâ‡∏≤ (EV)": 0.05,
        "‡∏°‡∏≠‡πÄ‡∏ï‡∏≠‡∏£‡πå‡πÑ‡∏ã‡∏Ñ‡πå": 0.10
    }
    c_transport = distance * t_factors[transport]

    # 2. ‡∏≠‡∏≤‡∏´‡∏≤‡∏£ (Keyword Matching ‡∏à‡∏≤‡∏Å‡∏Ñ‡∏≥‡∏ó‡∏µ‡πà‡∏û‡∏¥‡∏°‡∏û‡πå)
    # ‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏à‡∏≤‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Ç‡∏≠‡∏á TGO (‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì 1.2 - 3.8 kgCO2e)
    c_food = 1.5 # ‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ
    if any(word in food_input for word in ["‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏ß‡∏±‡∏ß", "beef", "‡∏ß‡∏±‡∏ß"]):
        c_food = 3.8
    elif any(word in food_input for word in ["‡∏´‡∏°‡∏π", "pork", "‡πÑ‡∏Å‡πà", "chicken"]):
        c_food = 1.5
    elif any(word in food_input for word in ["‡∏ú‡∏±‡∏Å", "‡∏™‡∏•‡∏±‡∏î", "vegetable", "‡∏°‡∏±‡∏á‡∏™‡∏ß‡∏¥‡∏£‡∏±‡∏ï‡∏¥"]):
        c_food = 0.6
    elif any(word in food_input for word in ["‡∏õ‡∏•‡∏≤", "fish", "‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ó‡∏∞‡πÄ‡∏•"]):
        c_food = 1.1

    # 3. ‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô‡πÑ‡∏ü‡∏ü‡πâ‡∏≤ (Grid Emission Factor ‡πÑ‡∏ó‡∏¢ ~ 0.5 kgCO2e/‡∏´‡∏ô‡πà‡∏ß‡∏¢)
    c_ac = ac_hours * 0.5 

    total_carbon = c_transport + c_food + c_ac

    # ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•
    st.balloons()
    st.header(f"‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡∏Ñ‡∏≤‡∏£‡πå‡∏ö‡∏≠‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∑‡∏≠: {total_carbon:.2f} kgCO2e")

    # ‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏ï‡∏≤‡∏°‡πÄ‡∏Å‡∏ì‡∏ë‡πå
    if total_carbon < 4:
        st.success("‡∏¢‡∏≠‡∏î‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°‡∏°‡∏≤‡∏Å! ‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏õ‡πá‡∏ô‡∏°‡∏¥‡∏ï‡∏£‡∏ï‡πà‡∏≠‡πÇ‡∏•‡∏Å‡∏™‡∏∏‡∏î‡πÜ üå±")
    elif total_carbon < 10:
        st.warning("‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á ‡∏•‡∏≠‡∏á‡∏õ‡∏£‡∏±‡∏ö‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏≠‡∏µ‡∏Å‡∏ô‡∏¥‡∏î‡∏à‡∏∞‡∏î‡∏µ‡∏°‡∏≤‡∏Å‡∏Ñ‡∏£‡∏±‡∏ö üå§Ô∏è")
    else:
        st.error("‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏≤‡∏£‡πå‡∏ö‡∏≠‡∏ô‡∏Ñ‡πà‡∏≠‡∏ô‡∏Ç‡πâ‡∏≤‡∏á‡∏™‡∏π‡∏á ‡∏•‡∏≠‡∏á‡∏î‡∏π‡∏ß‡∏¥‡∏ò‡∏µ‡∏•‡∏î‡πÅ‡∏•‡∏∞‡∏ä‡∏î‡πÄ‡∏ä‡∏¢‡∏Ç‡πâ‡∏≤‡∏á‡∏•‡πà‡∏≤‡∏á‡∏ô‡∏∞ üåã")

    # --- ‡∏™‡πà‡∏ß‡∏ô‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏ä‡∏î‡πÄ‡∏ä‡∏¢ ---
    st.subheader("üí° ‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏ï‡∏±‡∏ß‡πÅ‡∏•‡∏∞‡∏ä‡∏î‡πÄ‡∏ä‡∏¢‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏∏‡∏ì:")
    
    col1, col2 = st.columns(2)
    
    with col1:
        st.markdown("**üìâ ‡∏ß‡∏¥‡∏ò‡∏µ‡∏•‡∏î‡∏Å‡∏≤‡∏£‡∏õ‡∏•‡πà‡∏≠‡∏¢ (Reduce)**")
        if transport == "‡∏£‡∏ñ‡∏¢‡∏ô‡∏ï‡πå‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß (‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô)":
            st.write("- **‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á:** ‡∏ß‡∏±‡∏ô‡πÑ‡∏´‡∏ô‡πÑ‡∏°‡πà‡∏£‡∏µ‡∏ö ‡∏•‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡∏£‡∏ñ‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡∏ó‡∏≤‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô‡πÑ‡∏õ‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏±‡∏ô‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö")
        if c_food > 3:
            st.write("- **‡∏Å‡∏≤‡∏£‡∏Å‡∏¥‡∏ô:** ‡∏•‡∏≠‡∏á‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏à‡∏≤‡∏Å‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡πÅ‡∏î‡∏á‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡πÑ‡∏Å‡πà‡∏´‡∏£‡∏∑‡∏≠‡∏õ‡∏•‡∏≤ ‡∏à‡∏∞‡∏•‡∏î‡∏Ñ‡∏≤‡∏£‡πå‡∏ö‡∏≠‡∏ô‡πÑ‡∏î‡πâ‡∏°‡∏´‡∏≤‡∏®‡∏≤‡∏•")
        if ac_hours > 5:
            st.write("- **‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô:** ‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏≠‡∏£‡πå 26¬∞C ‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ‡∏û‡∏±‡∏î‡∏•‡∏°‡∏ä‡πà‡∏ß‡∏¢ ‡∏à‡∏∞‡∏ä‡πà‡∏ß‡∏¢‡πÇ‡∏•‡∏Å‡πÅ‡∏•‡∏∞‡∏ä‡πà‡∏ß‡∏¢‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü‡∏î‡πâ‡∏ß‡∏¢")

    with col2:
        st.markdown("**üå≥ ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ä‡∏î‡πÄ‡∏ä‡∏¢ (Offset)**")
        st.write("- **‡∏õ‡∏•‡∏π‡∏Å‡∏ï‡πâ‡∏ô‡πÑ‡∏°‡πâ:** ‡∏õ‡∏•‡∏π‡∏Å‡πÑ‡∏°‡πâ‡∏¢‡∏∑‡∏ô‡∏ï‡πâ‡∏ô 1 ‡∏ï‡πâ‡∏ô ‡∏ä‡πà‡∏ß‡∏¢‡∏î‡∏π‡∏î‡∏ã‡∏±‡∏ö‡∏Ñ‡∏≤‡∏£‡πå‡∏ö‡∏≠‡∏ô‡πÑ‡∏î‡πâ‡∏ñ‡∏∂‡∏á 9-15 kg ‡∏ï‡πà‡∏≠‡∏õ‡∏µ!")
        st.write("- **‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡∏¢‡∏∞:** ‡∏Å‡∏≤‡∏£‡πÅ‡∏¢‡∏Å‡∏Ç‡∏¢‡∏∞‡∏û‡∏•‡∏≤‡∏™‡∏ï‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏µ‡πÑ‡∏ã‡πÄ‡∏Ñ‡∏¥‡∏• ‡∏ä‡πà‡∏ß‡∏¢‡∏•‡∏î‡∏Å‡πä‡∏≤‡∏ã‡∏°‡∏µ‡πÄ‡∏ó‡∏ô‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏ù‡∏±‡∏á‡∏Å‡∏•‡∏ö")
        st.write("- **‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô‡∏Ñ‡∏≤‡∏£‡πå‡∏ö‡∏≠‡∏ô‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï:** ‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£ T-VER ‡∏Ç‡∏≠‡∏á ‡∏≠‡∏ö‡∏Å. ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏î‡∏Å‡πä‡∏≤‡∏ã‡πÉ‡∏ô‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏∏‡∏°‡∏ä‡∏ô")

st.divider()
st.caption("‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏Ñ‡πà‡∏≤‡∏™‡∏±‡∏°‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏Å‡∏≤‡∏£‡∏õ‡∏•‡πà‡∏≠‡∏¢‡∏Å‡πä‡∏≤‡∏ã‡πÄ‡∏£‡∏∑‡∏≠‡∏ô‡∏Å‡∏£‡∏∞‡∏à‡∏Å‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô‡∏à‡∏≤‡∏Å ‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏≤‡∏£‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡πä‡∏≤‡∏ã‡πÄ‡∏£‡∏∑‡∏≠‡∏ô‡∏Å‡∏£‡∏∞‡∏à‡∏Å (‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏≤‡∏£‡∏°‡∏´‡∏≤‡∏ä‡∏ô)")
